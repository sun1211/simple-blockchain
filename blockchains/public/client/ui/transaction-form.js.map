{"version":3,"file":"transaction-form.js","sourceRoot":"","sources":["../../../src/client/ui/transaction-form.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,IAAI,EAAkB,MAAM,4CAA4C,CAAC;AAElF,OAAO,EAAwB,EAAE,EAAE,MAAM,aAAa,CAAC;AAGvD,MAAM,OAAO,eAAe;IAG1B,YAAqB,gBAA0B;QAA1B,qBAAgB,GAAhB,gBAAgB,CAAU;QA4B9B,kBAAa,GAAG,CAAC,KAAY,EAAE,EAAE;YAChD,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,KAAK,CAAC,MAA0B,CAAC;YAC/D,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;YACrE,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC1B,CAAC,CAAC;QA/BA,IAAI,CAAC,SAAS,EAAE,CAAC;IACnB,CAAC;IAED,MAAM,CAAC,IAA8B;QACnC,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC;QACvD,MAAM,kBAAkB,GAAG,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,YAAY,CAAC;QAE9D,OAAO,IAAI,CAAA;;mDAEoC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,IAAI,CAAC;UACtF,EAAE,CAAC,SAAS,CAAC,QAAQ,EAAK,MAAM,EAAK,IAAI,CAAC,aAAa,EAAE,kBAAkB,CAAC;UAC5E,EAAE,CAAC,SAAS,CAAC,WAAW,EAAE,SAAS,EAAE,IAAI,CAAC,aAAa,EAAE,kBAAkB,CAAC;UAC5E,EAAE,CAAC,SAAS,CAAC,QAAQ,EAAK,MAAM,EAAK,IAAI,CAAC,aAAa,EAAE,kBAAkB,EAAE,QAAQ,CAAC;UACtF,EAAE,CAAC,MAAM,CAAC,iBAAiB,EAAE,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC;;KAEnE,CAAC;IACJ,CAAC;IAED,IAAY,SAAS;QACnB,OAAO,CAAC,CAAC,CACP,IAAI,CAAC,WAAW;YAChB,IAAI,CAAC,WAAW,CAAC,MAAM;YACvB,IAAI,CAAC,WAAW,CAAC,MAAM;YACvB,IAAI,CAAC,WAAW,CAAC,SAAS,CAC3B,CAAC;IACJ,CAAC;IAQO,kBAAkB,CAAC,KAAY,EAAE,IAA8B;QACrE,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QACtC,IAAI,CAAC,SAAS,EAAE,CAAC;IACnB,CAAC;IAEO,SAAS;QACf,IAAI,CAAC,WAAW,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;QACnE,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;CACF","sourcesContent":["import { html, TemplateResult } from '../../../node_modules/lit-html/lit-html.js';\r\nimport { BlockchainNode, Transaction } from '../lib/blockchain-node.js';\r\nimport { Callback, Renderable, UI } from './common.js';\r\n\r\n\r\nexport class TransactionForm implements Renderable<Readonly<BlockchainNode>> {\r\n  private transaction: Transaction;\r\n\r\n  constructor(readonly requestRendering: Callback) {\r\n    this.resetForm();\r\n  }\r\n\r\n  render(node: Readonly<BlockchainNode>): TemplateResult {\r\n    const { sender, recipient, amount } = this.transaction;\r\n    const shouldDisableField = node.isMining || node.chainIsEmpty;\r\n\r\n    return html`\r\n      <h2>New transaction</h2>\r\n      <form class=\"add-transaction-form\" @submit=${event => this.enqueueTransaction(event, node)}>\r\n        ${UI.formField('sender',    sender,    this.onFieldChange, shouldDisableField)}<span class=\"hidden-xs\">â†’</span>\r\n        ${UI.formField('recipient', recipient, this.onFieldChange, shouldDisableField)}\r\n        ${UI.formField('amount',    amount,    this.onFieldChange, shouldDisableField, 'number')}\r\n        ${UI.button('ADD TRANSACTION', node.isMining || !this.formValid)}\r\n      </form>\r\n    `;\r\n  }\r\n\r\n  private get formValid(): boolean {\r\n    return !!(\r\n      this.transaction &&\r\n      this.transaction.sender &&\r\n      this.transaction.amount &&\r\n      this.transaction.recipient\r\n    );\r\n  }\r\n\r\n  private readonly onFieldChange = (event: Event) => {\r\n    const { type, name, value } = event.target as HTMLInputElement;\r\n    this.transaction[name] = type === 'number' ? parseInt(value) : value;\r\n    this.requestRendering();\r\n  };\r\n\r\n  private enqueueTransaction(event: Event, node: Readonly<BlockchainNode>) {\r\n    event.preventDefault();\r\n    node.addTransaction(this.transaction);\r\n    this.resetForm();\r\n  }\r\n\r\n  private resetForm() {\r\n    this.transaction = { sender: null, recipient: null, amount: null };\r\n    this.requestRendering();\r\n  }\r\n}\r\n"]}